/* Bookmark/Star System */

/* Bookmark hover effects on paragraphs */
.diff-content .md-p,
.diff-content .md-list-item {
  position: relative;
  transition: background 0.15s ease;
  border-radius: var(--radius-sm);
}

.diff-content .md-p:has(a):hover,
.diff-content .md-list-item:has(a):hover {
  background: var(--accent-bg);
}

/* Bookmark button (injected dynamically) */
.bookmark-btn {
  position: absolute;
  right: -2.5rem;
  top: 50%;
  transform: translateY(-50%);
  width: 2.2rem;
  height: 2.2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  font-size: 1.4rem;
  font-weight: 700;
  color: #000;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease, transform 0.2s ease, filter 0.2s ease;
  z-index: 10;
}

/* Unstarred: show â˜† outline on line hover or keyboard focus */
.md-p:hover .bookmark-btn:not(.bookmark-btn-existing),
.md-list-item:hover .bookmark-btn:not(.bookmark-btn-existing),
.bookmark-btn:not(.bookmark-btn-existing):focus-visible {
  opacity: 0.4;
}

.md-p:hover .bookmark-btn:not(.bookmark-btn-existing)::after,
.md-list-item:hover .bookmark-btn:not(.bookmark-btn-existing)::after,
.bookmark-btn:not(.bookmark-btn-existing):focus-visible::after {
  content: 'â˜†';
  color: var(--accent);
}

.bookmark-btn:focus-visible {
  outline: none;
}

/* Unstarred: â˜† with + on direct hover */
.bookmark-btn:not(.bookmark-btn-existing):hover {
  opacity: 1 !important;
  transform: translateY(-50%) scale(1.2) !important;
}

.bookmark-btn:not(.bookmark-btn-existing):hover::after {
  content: 'â˜†' !important;
  color: var(--accent) !important;
  font-size: 1.8rem !important;
}

/* Already-starred: filled star, always visible */
.bookmark-btn-existing {
  background: var(--accent);
  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  opacity: 0.4;
  font-size: 0;
  transform: translateY(-50%) scale(0.75);
}

.bookmark-btn-existing:focus-visible {
  opacity: 0.8;
}

.md-p:hover .bookmark-btn-existing,
.md-list-item:hover .bookmark-btn-existing {
  opacity: 0.8;
}

.bookmark-btn-existing:hover {
  opacity: 1 !important;
  font-size: 1.2rem;
  transform: translateY(-50%) scale(1.2) !important;
  filter: brightness(1.1) !important;
}

.bookmark-btn-existing:hover::after {
  content: 'âˆ’';
  font-weight: 700;
  color: #000;
}

/* Highlighted bookmark paragraph */
.bookmark-highlight {
  animation: bookmark-pulse 2s ease-out;
}

/* Copy link button for public diffs (same position as star) */
.copy-link-btn {
  position: absolute;
  right: -2.5rem;
  top: 50%;
  transform: translateY(-50%);
  width: 2.2rem;
  height: 2.2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease, transform 0.2s ease;
  z-index: 10;
}

.copy-link-btn::after {
  content: 'ðŸ”—';
}

.md-p:hover .copy-link-btn,
.md-list-item:hover .copy-link-btn {
  opacity: 0.4;
}

.copy-link-btn:hover {
  opacity: 1 !important;
  transform: translateY(-50%) scale(1.2) !important;
}

/* Persistent highlight for public diff deep-links */
.bookmark-highlight-persistent {
  border-left: 2px solid var(--accent);
  animation: bookmark-settle 2s ease-out forwards;
}

/* "Copied" toast that zooms and fades from cursor */
.copy-toast {
  position: fixed;
  transform: translate(-50%, -50%) scale(0.6);
  pointer-events: none;
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--accent);
  background: var(--bg-surface);
  border: 1px solid var(--border);
  padding: 0.25rem 0.5rem;
  border-radius: 9999px;
  white-space: nowrap;
  z-index: 1000;
  animation: copy-zoom-fade 1.2s ease-out forwards;
}
