<!-- Sync Status Dropdown -->
<div class="sync-dropdown-wrapper" x-data="syncDropdown()" x-show="show" @click.stop @mouseenter="$store.app.openSyncDropdown()" @mouseleave="if (!needsPassword || !isOpen) close()" @click.outside="close()">
  <button class="sync-status" :title="state === 'syncing' ? 'Syncing...' : 'Sync status'" :disabled="syncing">
    <span class="sync-status-cloud">&#9729;</span>
    <span class="sync-status-indicator sync-status-spinning" x-show="state === 'syncing'">&#8635;</span>
    <span class="sync-status-indicator sync-status-pending" x-show="state === 'pending'">&#9670;</span>
    <span class="sync-status-indicator sync-status-ok" x-show="state === 'synced'">&#10003;</span>
    <span class="sync-status-indicator sync-status-hover" x-show="state === 'synced'">&#8635;</span>
  </button>
  <div class="sync-dropdown" x-show="isOpen" x-transition.opacity @click.stop>
    <div class="sync-dropdown-syncing" x-show="syncing">
      <span class="sync-dropdown-syncing-icon">&#8635;</span>
      <span>Syncing...</span>
    </div>
    <div class="sync-dropdown-result" x-show="result && !syncing">
      <span class="sync-dropdown-result-icon">&#10003;</span>
      <span x-text="result?.uploaded || result?.downloaded ? ((result?.uploaded ? '↑' + result.uploaded : '') + (result?.downloaded ? ' ↓' + result.downloaded : '') + ' synced') : 'In sync'"></span>
    </div>
    <div class="sync-dropdown-form" x-show="needsPassword && !syncing && !result">
      <div class="sync-dropdown-info" x-show="lastSyncedAgo"><span class="sync-paused">Paused</span> (synced <span x-text="lastSyncedAgo"></span>)</div>
      <div class="sync-dropdown-input-row">
        <input type="password" class="sync-dropdown-input" placeholder="Password" x-model="password" @keydown.enter="sync()" />
        <button class="sync-dropdown-btn-icon" @click="sync()" :disabled="!password" title="Sync now">&#8635;</button>
      </div>
      <label class="sync-dropdown-remember">
        <input type="checkbox" x-model="remember" />
        <span class="sync-dropdown-remember-text">Remember password</span>
      </label>
      <div class="sync-dropdown-error" x-show="error" x-text="error"></div>
    </div>
    <div class="sync-dropdown-status" x-show="!needsPassword && !syncing && !result">
      <span class="sync-dropdown-info">Synced <span x-text="lastSyncedAgo"></span></span>
      <button class="sync-dropdown-btn-icon" x-show="lastSyncedAgo !== 'just now'" @click="sync()" title="Sync now">&#8635;</button>
    </div>
    <button class="sync-dropdown-forget" x-show="!needsPassword && !syncing && !result" @click="forgetSavedPassword()" x-text="isRemembered ? 'forget stored password' : 'forget password'"></button>
  </div>
</div>
